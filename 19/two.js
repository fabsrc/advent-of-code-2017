function tubes (input) {
  const grid = input.split('\n').map(l => l.split(''))
  const isEmpty = i => i === ' '
  let [x, y] = [0, grid[0].indexOf('|')]
  let [dx, dy] = [1, 0]
  let steps = 0

  while (true) {
    const current = grid[x][y]

    if (isEmpty(current)) {
      return steps
    }

    if (current === '+') {
      if (dy === 0) {
        if (!isEmpty(grid[x][y + 1])) {
          [dx, dy] = [0, 1]
        } else if (!isEmpty(grid[x][y - 1])) {
          [dx, dy] = [0, -1]
        }
      } else {
        if (grid[x + 1] && !isEmpty(grid[x + 1][y])) {
          [dx, dy] = [1, 0]
        } else if (grid[x - 1] && !isEmpty(grid[x - 1][y])) {
          [dx, dy] = [-1, 0]
        }
      }
    }

    [x, y] = [x + dx, y + dy]
    steps++
  }
}

console.assert(tubes(
`     |          
     |  +--+    
     A  |  C    
 F---|----E|--+ 
     |  |  |  D 
     +B-+  +--+ `
) === 38)

console.log(tubes(
` |                                                                                                                                                                                                       
 |               +-------------------------------------------------------------+     +-------------------------------------------------+ +---+ +---------------------------------------------+   +-----+ 
 |               |                                                             |     |                                                 | |   | |                                             |   |     | 
 |               +---------------------------------------------------------------------------------------------------------------------|---------------------------------------------------+ |   |     | 
 |                                                                             |     |                                                 | |   | |                                           | |   |     | 
 +-----------------------------------------------------------------------------|-----------------------------------------------------------------------------------+                       | |   |     | 
                                                                               |     |                                                 | |   | |                   |                       | |   |     | 
                         +-----------------------------------------------------|-----|---------------------------------------------------|-----+   +---------------|---------------------+ | |   |     | 
                         |                                                     |     |                                                 | |   |     |               |                     | | |   |     | 
     +-------------------------------------------------------------------------------|-------------------------------------------------|-|---------|---------------------------------------------|---+ | 
     |                   |                                                     |     |                                                 | |   |     |               |                     | | |   |   | | 
     |                   |               +---+                         +---+ +-------|-------------------+                             | |   |     |               | +-------------+     | | |   |   | | 
     |                   |               |   |                         |   | | |     |                   |                             | |   |     |               | |             |     | | |   |   | | 
     |                   |               |   +-----------------------------|-|---------------------------|-----------------------------|-|---|-----------------------|-------------|-------|-|---|---+ | 
     |                   |               |                             |   | | |     |                   |                             | |   |     |               | |             |     | | |   |     | 
 +-------------+         +---------------------------------------------|-----|-|---------------------------------------------------+ +---+   |     | +-------------|---------------|-----+ | |   |     | 
 |   |         |                         |                             |   | | |     |                   |                         | | |     |     | |             | |             |       | |   |     | 
 |   |         |                         |           +---------------------+ | |     |         +---------|-------------------------+ | |     |     | |             | |             |       | |   |     | 
 |   |         |                         |           |                 |     | |     |         |         |                           | |     |     | |             | |             |       | |   |     | 
 |   |         +-------------------------|-----------------------------|-----|-|---------------|-------------------------------+   +-|-|-+   |     | |             | |             |       | |   |     | 
 |   |                                   |           |                 |     | |     |         |         |                     |   | | | |   |     | |             | |             |       | |   |     | 
 |   |                                 +-|-----------|-----------------|-----|---------------------------------------+         |   | | | |   |     | |             | |             |       | |   |     | 
 |   |                                 | |           |                 |     | |     |         |         |           |         |   | | | |   |     | |             | |             |       | |   |     | 
 |   |                 +---------+     | |         +-|-----------------|-----|-------|---------|---------------------+         |   | | | |   +-------|---------------|-+     +-----+       | |   |     | 
 |   |                 |         |     | |         | |                 |     | |     |         |         |                     |   | | | |         | |             | | |     |             | |   |     | 
 |   |                 |         |     | |         | |     +-----------|-----|-----------------|-------+ +---------------------------|-|---------------------------|-|-|---+ |             | |   |     | 
 |   |                 |         |     | |         | |     |           |     | |     |         |       |                       |   | | | |         | |             | | |   | |             | |   |     | 
 |   |                 |         |     | |         | | +---|-------+   | +---|-------|---------|-------|-----------------------------|---|U------------------------|-------|---------+     | |   |     | 
 |   |                 |         |     | |         | | |   |       |   | |   | |     |         |       |                       |   | | | |         | |             | | |   | |       |     | |   |     | 
 |   |                 |         |     | |         +---|-----------|---|-------|-----|-----------------|-----------------------------|-|-------------|----O------------|-+ | |       |     | |   |     | 
 |   |                 |         |     | |           | |   |       |   | |   | |     |         |       |                       |   | | | |         | |             | | | | | |       |     | |   |     | 
 |   |             +---------+   |     | |   +---------|---|-----+ |   | |   | | +-------------|-----------------------------------|-|-|-|-----------|-----+       | | +---+ |       |     | |   |     | 
 |   |             |   |     |   |     | |   |       | |   |     | |   | |   | | |   |         |       |                       |   | | | |         | |     |       | |   |   |       |     | |   |     | 
 |   |             |   |     |   |     | |   |       | |   |     | |   | +-----|-|---|---------|-------|-----------------------|---------------------|-----|-----------+ |   |       |     | |   |     | 
 |   |             |   |     |   |     | |   |       | |   |     | |   |     | | |   |         |       |                       |   | | | |         | |     |       | | | |   |       |     | |   |     | 
 |   |             |   |     |   |     | |   |   +---|-|---|-------|-------------|---------------------|-----------------------------|---|-------+ | |     |       | | | |   |     +-|-+   | |   |     | 
 |   |             |   |     |   |     | |   |   |   | |   |     | |   |     | | |   |         |       |                       |   | | | |       | | |     |       | | | |   |     | | |   | |   |     | 
 |   |             |   |     |   |     | |   |   |   +-|---|-----|-|-------------|---|-----------------|-----------------------|---|-------------|---|-------------------|-----+   | | |   | |   |     | 
 |   |             |   |     |   |     | |   |   |     |   |     | |   |     | | |   |         |       |                       |   | | | |       | | |     |       | | | |   | |   | | |   | |   |     | 
 |   |             |   |     |   |   +---|-----+ |     |   | +---------|-------------|-----------------|-----------------+     |   | | | |       | | |     |       | | | |   +-----|-------|-|-+ |     | 
 |   |             |   |     |   |   | | |   | | |     |   | |   | |   |     | | |   |         |       |                 |     |   | | | |       | | |     |       | | | |     |   | | |   | | | |     | 
 |   |             |   |     |   |   | | |   | | +-----|---|-|---------------|---|-------------|-------------------------|-----|---|-|-|---------|-|---------------|-|-|-|---+ |   | | |   | | | |     | 
 |   |             |   |     |   |   | | |   | |       |   | |   | |   |     | | |   |         |       |                 |     |   | | | |       | | |     |       | | | |   | |   | | |   | | | |     | 
 |   |             |   |     |   |   | | |   | |       |   | | +-|-|---------|---|---|---------|-------|-----------------|-----|---|---|-+ +---+ | | | +---|---------|--R----|-|---|-|-|---|---+ |     | 
 |   |             |   |     |   |   | | |   | |       |   | | | | |   |     | | |   |         |       |                 |     |   | | |   |   | | | | |   |       | | | |   | |   | | |   | |   |     | 
 |   | +---------------|---------|---|-|---+ | |       +-+ | | | | +---|---+ | | |   +-----------------|-----------------|-------------|---------|-|-------------------|-|-----|---|-|-|---|---+ |     | 
 |   | |           |   |     |   |   | | | | | |         | | | | |     |   | | | |             |       |                 |     |   | | |   |   | | | | |   |       | | | |   | |   | | |   | | | |     | 
 |   | |           |   |     |   |   | | | | +-+         | | | | |     |   | | | |             |   +---|-----------------|-----+   | +-----|-----|-----|-----------|-|---|-----|-----------|-|-|-|---+ | 
 |   | |           |   |     |   |   | | | |             | | | | |     |   | | | |             |   |   |                 |         |   |   |   | | | | |   |       | | | |   | |   | | |   | | | |   | | 
 |   | +-----------|---------|---|---|-------------------------|-------|---|-|-|---------------|-------|-----------------|-----+   |   +-+ |   | | | | |   |       | | | |   | |   | | |   | | | |   | | 
 |   |             |   |     |   |   | | | |             | | | | |     |   | | | |             |   |   |                 |     |   |     | |   | | | | |   |       | | | |   | |   | | |   | | | |   | | 
 |   |             |   |     |   |   | | | |             | | | | |     |   | | | |             |   |   |         +-----------------|-------|---|-|-----|-----------|-|-|-----+ |   | | +---+ | | |   | | 
 |   |             |   |     |   |   | | | |             | | | | |     |   | | | |             |   |   |         |       |     |   |     | |   | | | | |   |       | | | |     |   | |       | | |   | | 
 |   |             |   |     |   |   | | | |             | | | | |     |   | | | |             |   |   |         |       |     |   |     | |   | | | | |   |       | | | |     |   | |       | | |   | | 
 |   |             |   |     |   |   | | | |             | | | | |     |   | | | |             |   |   |         |       |     |   |     | |   | | | | |   |       | | | |     |   | |       | | |   | | 
 |   |           +-|---|-----|-------|-|---+             | | | | |     |   | | +-+             |   |   |         |       |     |   |     | |   | | | | |   |       | | | |     |   | |       | | |   | | 
 |   |           | |   |     |   |   | | |               | | | | |     |   | |                 |   |   |         |       |     |   |     | |   | | | | |   |       | | | |     |   | |       | | |   | | 
 |   |           | |   |     |   |   | | |               | | | | |     |   | |                 |   |   |         |       |     |   |     | |   | | | | |   |       | | | |     |   | |       | | |   | | 
 |   |           | |   |     |   |   | | |               | | | | |     |   | |                 |   |   |         |       |     |   |     | |   | | | | |   |       | | | |     |   | |       | | |   | | 
 |   |           | |   |     |   |   | | |               | | | | |     |   | +---------------+ |   |   |         |       |     |   |     | |   | | | | |   |       | | | |     | +-----------|-+ |   | | 
 |   |           | |   |     |   |   | | |               | | | | |     |   |                 | |   |   |         |       |     |   |     | |   | | | | |   |       | | | |     | | | |       |   |   | | 
 | +-------------+ |   |   +-|---|---|---|---------------------|-|-----|-----------------------+   |   |         |       |     |   |     | |   | | | | |   |       | | | |     | +-|-+       |   |   | | 
 | | |             |   |   | |   |   | | |               | | | | |     |   |                 |     |   |         |       |     |   |     | |   | | | | |   |       | | | |     |   |         |   |   | | 
 | | |             |   |   | |   |   | | |               | | | | |     |   |                 |     |   |         |     +-|---------|-----|-|-+ +-|-|-------|---+   | | | |     |   |         |   |   | | 
 | | |             |   |   | |   |   | | |               | | | | |     |   |                 |     |   |         |     | |     |   |     | | |   | | | |   |   |   | | | |     |   |         |   |   | | 
 | | |             |   |   | |   +-----------------------|-|-|-|-|-----------------------------------------------|-----+ |     |   |     | | |   | | | |   |   |   | | | |     |   |         |   |   | | 
 | | |             |   |   | |       | | |               | | | | |     |   |                 |     |   |         |       |     |   |     | | |   | | | |   |   |   | | | |     |   |         |   |   | | 
 | | |             |   |   | |       | | |               | | | | |     |   |   +---------------+   |   |         |       |     |   |     | | |   | | | |   |   |   | | | |   +-----|---------|---+   | | 
 | | |             |   |   | |       | | |               | | | | |     |   |   |             | |   |   |         |       |     |   |     | | |   | | | |   |   |   | | | |   | |   |         |       | | 
 | | |             |   |   | |       | | |       +---------|-|-|-------|---|-----------------|---+ |   |         |       +-----|-------------|---|-|-|-|---|-------|-----------|-------------------+ | | 
 | | |             |   |   | |       | | |       |       | | | | |     |   |   |             | | | |   |         |             |   |     | | |   | | | |   |   |   | | | |   | |   |         |     | | | 
 | | |             |   | +-|-|-----------|---------------|---|-|-|---------|-----------------|---------------------------------|---|-----------+ | | | |   |   |   | | | |   | |   |         |     | | | 
 | | |             |   | | | |       | | |       |       | | | | |     |   |   |             | | | |   |         |             |   |     | | | | | | | |   |   |   | | | |   | |   |         |     | | | 
 | +---+           |   | | | |       | | |       |       | | | | |     |   |   |             | | | |   |         |             |   |     | | | | | | | |   |   +-+ | | | |   | |   |         |     | | | 
 |   | |           |   | | | |       | | |       |       | | | | |     |   |   |             | | | |   |         |             |   |     | | | | | | | |   |     | | | | |   | |   |         |     | | | 
 |   | |           |   | | | +-------|-|-|-------|-------|---|---|-----|---|---+           +---|-----------------+             |   |     | | | | | | | |   |     | | | | |   | |   |         |     | | | 
 |   | |           |   | | |         | | |       |       | | | | |     |   |               | | | | |   |                       |   |     | | | | | | | |   |     | | | | |   | |   |         |     | | | 
 |   | |           |   | | |         | | |       |       | | | | |     |   |               | | | | |   |                       |   |     | | | | | | | |   |     | | | | |   | |   |         |     | | | 
 |   | |           |   | | |         | | |       |       | | | | |     |   |               | | | | |   |                       |   |     | | Z | | C | |   |     | | | | |   | |   |         |     | | | 
 |   | |           |   | | |         | | |       | +---+ | | | | |     |   |               | | | | |   |                       |   |     | | | | | | | |   |     | | | | |   | |   |         |     | | | 
 |   | |           |   | | |         | | |       | |   | | | | | |     |   |               | | | | |   |                       |   |     | | | | | | | |   |     | | | | |   | |   |         |     | | | 
 |   | |           |   | | |         | | | +-----|---------|-|-|-------------------------+ | | | | |   |                       |   |     | | | | | | | +-------+ | | | | |   | |   |         |     | | | 
 |   | |           |   | | |         | | | |     | |   | | | | | |     |   |             | | | | | |   |                       |   |     | | | | | | |     |   | | | | | |   | |   |         |     | | | 
 |   | |           |   | | |         | | | |     | |   | | | | | |     |   |             | | | | | |   |                       |   |     | | | | +---|---+ | F +-----|---|---------|---------------|-+ | 
 |   | |           |   | | |         | | | |     | |   | | | | | |     |   |             | | | | | |   |                       |   |     | | | |   | |   | | |   | | | | |   | |   |         |     |   | 
 |   | |           |   | | |         | | | |     | |   | | | | | |     |   |             | | | | | |   |                       +-------+ | | | |   | |   | | |   | | | | |   | |   |         |     |   | 
 |   | |           |   | | |         | | | |     | |   | | | | | |     |   |             | | | | | |   |                           |   | | | | |   | |   | | |   | | | | |   | |   |         |     |   | 
 |   | |           |   | | |         | | | |     | |   | | | | | |     |   |             | +---|-|-|---|-----------+               |   +-------|---|-|-------|-+ | | | | |   | |   |         | +---|-+ | 
 |   | |           |   | | |         | | | |     | |   | | | | | |     |   |             |   | | | |   |           |               |     | | | |   | |   | | | | | | | | |   | |   |         | |   | | | 
 |   | |           | +---|-----------------------|-----|-|-----|-------|---------------------------|---------------|---------------------------------|---|-|-|---|-------+   | |   |         | |   | | | 
 |   | |           | | | | |         | | | |     | |   | | | | | |     |   |             |   | | | |   |           |               |     | | | |   | |   | | | | | | | |     | |   |         | |   | | | 
 |   | |           | | | | |         | | | |     | |   +---|-|---------------------------|---|---------------------|-----+         +-------|-|-|-----|---|-|-|-------|-+ +---|-----------+   | |   | | | 
 |   | |           | | | | |         | | | |     | |     | | | | |     |   |             |   | | | |   |           |     |               | | | |   | |   | | | | | | |   |   | |   |     |   | |   | | | 
 |   | |       +---|---|---|-----------+ | |     | |     | | | | |     |   |             |   | | | |   +-----------|-----|-----------------|-|-|---|-|---------|---|---+ |   | |   |     |   | |   | | | 
 |   | |       |   | | | | |         |   | |     | |     | | | | |     |   |             |   | | | |               |     |               | | | |   | |   | | | | | | | | |   | |   |     |   | |   | | | 
 |   | |       |   | | | | |         |   | |     +---------------|---------+             |   | | | |       +-------|---------------------|---|-------------+ +-|-+ | | | |   | |   |     |   | |   | | | 
 |   | |       |   | | | | |         |   | |       |     | | | | |     |                 |   | | | |       |       |     |               | | | |   | |   |     |   | | | |   | |   |     |   | |   | | | 
 |   | |       |   | | | | |         |   | |       |     | | | | |     |                 |   | | | |       |       |     |               | | | |   | |   |     |   | | | |   | |   |     |   | |   | | | 
 |   | |       |   | | | | |         |   | |       |     | | | | |     |                 |   | | | |       |       |     |               | | | |   | |   |     |   | | | |   | |   |     |   | |   | | | 
 |   | |       |   | | | | |         |   | |       |     | | | | |     |                 |   | | | |       |       |     |               | | | |   | |   |     |   | | | |   | |   |     |   | |   | | | 
 |   | |       |   | | | | |         |   | |       |     | | | | |     |                 |   | | | |       |       |     |               | | | |   | |   |     |   | | | |   | |   |     |   | |   | | | 
 |   | |       |   | | | | |         |   | |       |     | | | | |     |           +-+   |   +---|-------+ |       |     +-------------+ | | | |   | |   |     |   | | | |   | |   |     |   | |   | | | 
 |   | |       |   | | | | |         |   | |       |     | | | | |     |           | |   |     | | |     | |       |                   | | | | |   | |   |     |   | | | |   | |   |     |   | |   | | | 
 |   | |       |   | | | | |         |   | |       |     | | | | |     |           | |   |     | | |     | |       |                   | | | | |   | |   |     |   | | | |   | |   |     |   | |   | | | 
 |   | |       |   | | | | |         |   | |       |     | | | | |     |           | |   |     | | |     | |       |                   | | | | |   | |   |     |   | | | |   | |   |     |   | |   | | | 
 |   | |       |   | | | +-|-------------|---------|---------|-|-------|-----------|-|---------|-|-|-------|-----------------------------|---+ |   | |   |     |   | | | |   | |   |     |   | |   | | | 
 |   | |       |   | | |   |         |   | |       |     | | | | |     |           | |   |     | | |     | |       |                   | | |   |   | |   |     |   | | | |   | |   |     |   | |   | | | 
 |   | |       |   | | |   |         |   | |       |     | | | | |     |           | |   |     | | |     | |       |                   | | |   |   | |   |     |   | | | |   | |   |     |   | |   | | | 
 |   | |       |   | | |   |         |   | |       |     | | | | |     |           | |   |     | | |     | |       |                   | | |   |   | |   |     |   | | | |   | |   |     |   | |   | | | 
 |   | |       |   | | |   |       +-|---|-|-------|-------|-|-|-------------------|-|-+ |     | | |     | |       |                   | | |   |   | |   |     +-----|---+ +-|---------------|---+ | | | 
 |   | |       |   | | |   |       | |   | |       |     | | | | |     |           | | | |     | | |     | |       |                   | | |   |   | |   |         | | |   | | |   |     |   | | | | | | 
 |   | |       |   | | |   |       | |   | |       |     | | | | |     |           | | | |     | | |     | |       |                   | | |   |   | |   |         | | |   | | |   |     |   | | | | | | 
 |   | |       |   | | |   |       | |   | |       |     | | | | |     |           | | | |     | | |     | |       |                   | | |   |   | |   |         | | |   | | |   |     |   | | | | | | 
 | +---|-----------|-|-|-----------|-|---|-------------------|---------|--E--------|---------------|-----|-+       |       +-------+   | | |   |   | |   |         | | |   | | |   |     |   | | | | | | 
 | | | |       |   | | |   |       | |   | |       |     | | | | |     |           | | | |     | | |     |         |       |       |   | | |   |   | |   |         | | |   | | |   |     |   | | | | | | 
 | | | |       |   | | |   |       | |   | |       |     | | | | |     |           | | | |     | | |     |         |       |       |   | | |   |   | |   |         | | |   | | |   |     |   | | | | | | 
 | | | |       |   | | |   |       | |   | |       |     | | | | |     |           | | | |     | | |     |         |       |       |   | | |   |   | |   |         | | |   | | |   |     |   | | | | | | 
 | | | +-------|---|---+   |       | |   | |       |     | | | | |     |           | | | |     | | |     |         |       |       |   | | |   |   | |   |         +---------|-|---+     |   | | | | | | 
 | | |         |   | |     |       | |   | |       |     | | | | |     |           | | | |     | | |     |         |       |       |   | | |   |   | |   |           | |   | | |         |   | | | | | | 
 | | |         |   | | +---|-------------|-|-------|-------------|-------------------+ | |     | | |     |         |       |       |   | | |   |   | |   |           | |   | | |         |   | | | | | | 
 | | |         |   | | |   |       | |   | |       |     | | | | |     |           |   | |     | | |     |         |       |       |   | | |   |   | |   |           | |   | | |         |   | | | | | | 
 | | |         |   | | |   |       | |   | |       |     | | | | |     |           |   | |     | | |     |         |       |       +---+ | |   |   | |   |         +-|-+   | | |         |   | | | | | | 
 | | |         |   | | |   |       | |   | |       |     | | | | |     |           |   | |     | | |     |         |       |             | |   |   | |   |         | |     | | |         |   | | | | | | 
 | | |         |   | | |   +---------|---|---------------|-|-|-|-|-----|---+     +-|-----------|-|-|-----------------------|-------------------|-------------------|-|-------|---+       |   | | | | | | 
 | | |         |   | | |           | |   | |       |     | | | | |     |   |     | |   | |     | | |     |         |       |             | |   |   | |   |         | |     | | | |       |   | | | | | | 
 | | |         |   | | |           +-|-------------|-------|---|-------|---------------|-|-----------+   |         |       |             | |   |   | |   |         | |     | | | |       |   | | | | | | 
 | | |         |   | | |             |   | |       |     | | | | |     |   |     | |   | |     | | | |   |         |       |             | |   |   | |   |         | |     | | | |       |   | | | | | | 
 | | |     +-------|-|-|-------------------|-------|-------|---|-----------|-------------+     | +-|-|---|-----------------|-------------------|---------|-------------------|---|-----------|---|-----+ 
 | | |     |   |   | | |             |   | |       |     | | | | |     |   |     | |   |       |   | |   |         |       |             | |   |   | |   |         | |     | | | |       |   | | | | |   
 | | |     |   |   | | | +-------------+ | |       | +---------------------|-----|-|-----------|---|-|-------------|-------|-----------+ | |   |   | |   |         | |     | | | |       | +-----|-+ |   
 | | |     |   |   | | | |           | | | |       | |   | | | | |     |   |     | |   |       |   | |   |         |       |           | | |   |   | |   |         | |     | | | |       | | | | |   |   
 | | |     |   |   | | | |   +-------------|---------+   | | | | | +---|---------|-----|-------|---|-|---------------------|-----------+ | |   |   | |   |         | |     | | | |       | | | | |   |   
 | | |     |   |   | | | |   |       | | | |       |     | | | | | |   |   |     | |   |       |   | |   |         |       |             | |   |   | |   |         | |     | | | |       | | | | |   |   
 | | |     |   |   | | +-----|---------|-|-|-------------|---|-|-|-|-------------+ |   |       |   | |   |         |       |             | |   |   | |   |         | |     | | | |       | | | | | +---+ 
 | | |     |   |   | |   |   |       | | | |       |     | | | | | |   |   |       |   |       |   | |   |         |       |             | |   |   | |   |         | |     | | | |       | | | | | | | | 
 | | |     |   |   | | +-------------|-|-----------------|---|---|-|---|---|-------|---|-----------+ | +-|---------|--------------M------|---------------------+ +-+ |     | | | |       | | | | | | | | 
 | | |     |   |   | | | |   |       | | | |       |     | | | | | |   |   |       |   |       |     | | |         |       |             | |   |   | |   |     | |   |     | | | |       | | | | | | | | 
 | | |     |   |   | | | |   |       | | | |       |     | | | | | |   |   |       |   |       |   +---|---+       |       |             | |   | +-|-----------|-|---|-----|-+ | |   +---|---|---|-|-|-+ 
 | | |     |   |   | | | |   |       | | | |       |     | | | | | |   |   |       |   |       |   | | | | |       |       |             | |   | | | |   |     | |   |     |   | |   |   | | | | | | |   
 | | |     |   |   | | | |   |       | | | |       |     | | | | | |   |   |       |   |       |   | | | | |       |       |             | |   | | | | +-|-----|-----------|---|-----|---|-|-|---|-|-|-+ 
 | | |     |   |   | | | |   |       | | | |       |     | | | | | |   |   |       |   |       |   | | | | |       |       |             | |   | | | | | |     | |   |     |   | |   |   | | | | | | | | 
 | | |     |   | +-----|-|---|---+   | | | |       |     | | | | | |   |   |       |   |       |   | | | | |       |       |             | |   | | | | | |     | |   |     |   | |   |   | | | | | | | | 
 | | |     |   | | | | | |   |   |   | | | |       |     | | | | | |   |   |       |   |       |   | | | | |       |       |             | |   | | | | | |     | |   |     |   | |   |   | | | | | | | | 
 | | |     |   | | | | | +---|-------|-|-+ |       |     | | | | | |   |   |       |   |       |   | | | | |       |       |             | |   | | | | | |     | |   |     |   | |   |   | | | | | | | | 
 | | |     |   | | | | |     |   |   | |   |       |     | | | | | |   |   |       |   |       |   | | | | |       |       |             | |   | | | | | |     | |   |     |   | |   |   | | | | | | | | 
 | | |     |   | | | | |     |   +---|-|---|-------|-------|-------+   +-----------|---|-------------|-|-|-|-------|-------+             | | +---|---|---|-----|-----------------+   |   | | | | | | | | 
 | | |     |   | | | | |     |       | |   |       |     | | | | |         |       |   |       |   | | | | |       |                     | | | | | | | | |     | |   |     |   |     |   | | | | | | | | 
 | | |     |   | | | | +---------------------------+     | | | | |         |       |   |       |   | | | | |       |       +-------------+ +-+ | | | | | |     | |   |     |   |     |   | | | | +-+ | | 
 | | |     |   | | | |       |       | |   |             | | | | |         |       |   |       |   | | | | |       |       |                   | | | | | |     | |   |     |   |     |   | | | |     | | 
 | | +-----|-+ | | | |       |       | |   | +-----------|-------|---------|---+   |   |       |   | | | | |       |       |           +---+ +-------|-|-+     | |   |     |   |     |   | | | |     | | 
 | |       | | | | | |       |       | |   | |           | | | | |         |   |   |   |       |   | | | | |       |       |           |   | | | | | | |       | |   |     |   |     |   | | | |     | | 
 | |       | | | | | |       |       | |   | |           | | | | |         |   |   |   |       |   | | | | |       |       |           |   | | | | | +-|---------|---|---------------------|-------+ | | 
 | |       | | | | | |       |       | |   | |           | | | | |         |   |   |   |       |   | | | | |       |       |           |   | | | | |   |       | |   |     |   |     |   | | | |   | | | 
 | |       | | | | | |       |       | |   | |           | | | | |         |   +-------|-------------|-------------|-----------------------|-----|-|-----------|-|-+ |     |   |     |   | | | |   | | | 
 | |       | | | | | |       |       | |   | |           | | | | |         |       |   |       |   | | | | |       |       |           |   | | | | |   |       | | | |     |   |     |   | | | |   | | | 
 | |       | | | | | |       |       | |   | |           | | | | |         |       |   |       |   | | | | |       |       +-+         |   | | | | |   |       | | | |     |   |     |   | | | |   | | | 
 | |       | | | | | |       |       | |   | |           | | | | |         |       |   |       |   | | | | |       |         |         |   | | | | |   |       | | | |     |   |     |   | | | |   | | | 
 | |       | | | | | |       |       | |   | |           | | | | |         |       |   |       |   | | | | |       |         |         | +-|-|-|-|-------------|-|-|-+     |   |     |   | | | |   | | | 
 | |       | | | | | |       |       | |   | |           | | | | |         |       |   |       |   | | | | |       |         |         | | | | | | |   |       | | |       |   |     |   | | | |   | | | 
 | |       | | | | | |       |       | |   | |           | | | | |         |       |   +-------|-----|-----|-----------------|---------|---|-+ | | |   |       | | |       |   |     |   +-+ | |   | | | 
 | |       | | | | | |       |       | |   | |           | | | | |         |       |           |   | | | | |       |         |         | | |   | | |   |       | | |       |   |     |       | |   | | | 
 | | +---------|-----------+ |       | |   | |         +-----|-----------------+   +-----------|---------|-+       |       +-|-------+ | | +---+ | |   | +-+   | +-|---------------+ |       | |   | | | 
 | | |     | | | | | |     | |       | |   | |         | | | | | |         |   |               |   | | | |         |       | |       | | |       | |   | | |   |   |       |   |   | |       | |   | | | 
 | | |     | | | | | |     | |       | |   | |         | | | | | |         |   |               |   | | | |         |       | |       +-|-|-------+ |   | | |   |   |       |   |   | |       | |   | | | 
 | | |     | | | | | |     | |       | |   | |         | | | | | |         |   |               |   | | | |         |       | |         | |         |   | | |   |   |       |   |   | |       | |   | | | 
 | | |     | | | | | +-------|-------------|-|---------|---|---|-|-----------------------------|-------|-|-----------------------------|-|-------------|-|-|-------|-----------------|-------|-|---|-+ | 
 | | |     | | | | |       | |       | |   | |         | | | | | |         |   |               |   | | | |         |       | |         | |         |   | | |   |   |       |   |   | |       | |   |   | 
 | | |     | | | | |       | |       | |   | |         | +-|---|-|---------|-----------------------------------------------|-|-----------|---------|---|-|-------+ |       |   |   | |       | | +---+ | 
 | | |     | | | | |       | |       | |   | |         |   | | | |         |   |               |   | | | |         |       | |         | |         |   | | |   | | |       |   |   | |       | | | | | | 
 | | |     | | | | |       | |       | |   | |         |   | | | |         |   |               |   | | | |         |       | |         | |         |   | | |   | | |       |   |   | |       | | | | | | 
 | | |     | | | | |       | |       | |   | |         |   | | | |         |   |               |   | | | |         |       | |         | |         |   | | |   | | |       |   |   | |       | | | | | | 
 | | +-------|-----+       | |       | |   | |         |   | | | |         +---|---------------|-------|-|---------|-------------------------------|---+ | |   | | |       |   |   | |       | | | | | | 
 | |       | | | |         | |       | |   | |         |   | | | |             |               |   | | | |         |       | |         | |         |     | |   | | |       |   |   | |       | | | | | | 
 +-|---------|-----------------------------|-|-------------|---|---------------|-------------------|---|-|-----------------------------+ |         |   +-|-----|---|-------|-----+ | |       | | | | | | 
   |       | | | |         | |       | |   | |         |   | | | |             |               |   | | | |         |       | |           |         |   | | |   | | |       |   | | | |       | | | | | | 
   |       | | | |         | |       | +-------------------|---|-|-----------------------------|---|---|-|---------|-----------------------------------+ | |   | | |       |   | | | |       | | | | | | 
   |       | | | |         | |       |     | |         |   | | | |             |               |   | | | |         |       | |           |         |     | |   | | |       |   | | | |       | | | | | | 
   |       | | | |         | |       |     | |         |   | | | |             |               |   | | | | +---------------|-|-----------+         |     | |   +---|-----------|---|-------------+ | | | 
   |       | | | |         | |       |     | |         |   | | | |             |               |   | | | | |       |       | |                     |     | |     | |       |   | | | |       | |   | | | 
   |       | | | |         +-|-------|-----|-----------+   | | | |             |               |   | | +-|-|-------|---------|---------+           +-------|-------|---------+ | | | |       | |   | | | 
   |       | | | |           |       |     | |             | | | |             |               |   | |   | |       |       | |         |                 | |     | |       | | | | | |       | |   | | | 
   |       | | | |           |   +---|-----+ |             | | | |             |     +---------+   +-|---+ +---------------|-|---------|-----------------|-+     | |       | | | | | |       | |   | | | 
   |       | | | |           |   |   |       |             | | | |             |     |               |             |       | |         |                 |       | |       | | | | | |       | |   | | | 
   |       | | | |           |   |   |       |             | | | |             |     +-----------------------------+       +-+     +-----------------------------+ |       | | | | | | +-+   +-+   | | | 
   |       | | | |           |   |   |       |             | | | |             |                     |                             |   |                 |         |       | | | | | | | |         | | | 
   |       | | | |           |   +-----------|-------------|---+ |             |                     +---------------------------------+                 |         |       | +-+ | | | | +---+ +---+ | | 
   |       | | | |           |       |       |             | |   |             |                                                   |                     |         |       |     | | | |     | |     | | 
   |       | | | |           |       |       |             | |   +-------------|---------------------------------------------------------+               | +-------+       | +---|-|-|-|-+   +-+   +-+ | 
   |       | | | |           |       |       |             | |                 |                                                   |     |               | |               | |   | | | | |         |   | 
   |       | | | |           |       |       |             | |                 +---------------------------------------------------------|---------------------------------|-+   | | +-|-+         |   | 
   |       | | | |           |       |       |             | |                                                                     |     |               | |               |     | |   |           |   | 
   |   +-------|-+           +---------------|-------------+ |                                   +---------------------------------|-----|---------------------------------------+ |   |           |   | 
   |   |   | | |                     |       |               |                                   |                                 |     |               | |               |       |   |           |   | 
   | +-+   | +-+                     |       |               | +---------------------------------|---------------------------------------+               | |               +--Q--+ +-+ |           |   | 
   | |     |                         |       |               | |                                 |                                 |                     | |                     |   | |           |   | 
   | +-----+                         |       +---------------|-+         +-----------------------+                                 +---------------------+ +---------------------+   +-|-----------+   | 
   |                                 |                       |           |                                                                                                             |               | 
   |                                 +-----------------------+           +-------------------------------------------------------------------------------------------------------------+               | 
   |                                                                                                                                                                                                   | 
   +---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+ 
                                                                                                                                                                                                         `
))
